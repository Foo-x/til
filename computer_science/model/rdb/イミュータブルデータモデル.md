# イミュータブルデータモデル

CRUDのうち最も複雑な処理であるUPDATEを使わないで済むようにデータモデルを設計する方法。  
データを更新するときはUPDATEではなく、イベントとしてレコードに残す。  
特定時点でのデータをすべて残せるのがメリット。

設計方法は基本的に [TMによる設計](./TM%E3%81%AB%E3%82%88%E3%82%8B%E8%A8%AD%E8%A8%88.md) と同じ。  
データをイベントとリソースに分けることで、イベントは更新の必要がなくなり、リソースのみ検討を行えば良い。  
リソースを更新するユースケースがある場合でも、最新のデータとその履歴が必要なだけであれば、最新の更新イベントとjoinするだけで良い。  
マテリアライズドビューを使えばクエリも簡単。

複雑なのは特定時点のデータを取得したいときと、未来のデータを持つ必要があるとき。  
この場合はGitと同様にバージョンを管理すると良い。

参考: [イミュータブルデータモデル - kawasima](https://scrapbox.io/kawasima/%E3%82%A4%E3%83%9F%E3%83%A5%E3%83%BC%E3%82%BF%E3%83%96%E3%83%AB%E3%83%87%E3%83%BC%E3%82%BF%E3%83%A2%E3%83%87%E3%83%AB)
