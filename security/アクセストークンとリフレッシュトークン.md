# アクセストークンとリフレッシュトークン

実際に認証・認可で使うのはアクセストークン。  
毎リクエストに設定するので、リスクを抑えるために有効期限を短めの1時間などにする。

アクセストークンの有効期限が切れるたびに再認証するのはUXが悪いので、リフレッシュトークンを使ってリフレッシュする。  
したがってリフレッシュトークンの有効期限は長めの1日などにする。  
リフレッシュするときだけに使い、漏洩するリスクが低いため長めにできる。

リフレッシュトークンによるリフレッシュは1回だけできるようにする。  
悪用された場合は2回以上使われることになるので、漏洩していることを検知できる。  
検知したらすべてのトークンを無効化して再認証を強制することで、被害を最小限にできる。  
なので、リフレッシュ時にアクセストークンだけでなくリフレッシュトークンもローテーションする。
