# 静的サイトにおける認証

方法は大きく分けて2つ。

- IDaaSのライブラリを使う
    - Plus
        - 認証部分をIDaaSとそのライブラリに丸投げできるので簡単
    - Minus
        - IDaaSの料金がかかる
- 認証用のAPIを用意する
    - Plus
        - IDaaSに依存せず、その分の料金もかからない
    - Minus
        - 実装コストがかかる
    - Interest
        - IDaaSとAPIでどちらの利用料が安いかは要調査

どちらであっても認証後の画面はクライアント側で組み立てる。(Gatsbyでいうところの Client-only Routes)  
静的にしてしまうと認証していない状態でアクセスできてしまうため。

画面に表示するデータを動的にするのはまた別の問題。  
データを返すAPIを別に用意し、認証が不要であれば直接実行すれば良い。  
認証が必要であればトークンを受け取るようにして、導入した認証方法で検証する。

[APIの認証](./API%E3%81%AE%E8%AA%8D%E8%A8%BC.md) も参照。

ページ遷移するたびにローディング中の描画、APIに認証情報を渡してデータ取得、取得したデータで再描画を行う。  
Reactであればそのあたりをいい感じに管理してくれる [SWR](https://swr.vercel.app/ja) というライブラリがある。
