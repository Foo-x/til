# コミットしない変更を保持する方法

追跡されていないファイルであればGitと同様に以下のようにするとコミットされない。

- 全メンバー共通で作成するがコミットしたくないとき
    - `.gitignore` に記述する
- 自分だけ作成するがコミットしたくないとき
    - `.git/info/exclude` に記述する

jujutsuでは自動でコミットされるので、追跡されているファイルをローカルのみで変更してコミットしたくないときは工夫する必要がある。  
具体的には以下のようにする。

1. 設定 `git.private-commits` にpushしないコミットのルールを設定する
    - たとえば `description(glob:'private:*')` とするとコミットメッセージが `private:` で始まるものをpushできなくなる
2. コミットしたくない変更を上で設定したルールのコミットに含める
    - コミットxとする
3. `jj new x y` で上のコミットとマージしたコミットを作成する
    - コミットyはpushに含める最新のコミットとする
    - マージコミットをzとする
4. コミットz以降で開発を進める
    - pushする最新のコミットをwとする
5. コミットaにブランチを作成または移動する
6. `jj rebase -r x w` のようにしてプライベートコミットをpushするコミットより先に移動させる
    - コミットx'とする
8. ブランチをpushする
9. 以降の開発も同様に `jj new w x'` として、プライベートコミットとマージしたコミットで開発し、pushする前にプライベートコミットをrebaseしてpushに含めないようにする

